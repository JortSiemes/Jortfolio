<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-H1EZT1Q9H0"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-H1EZT1Q9H0');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Peruse</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="../css/peruse.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
</head>
<body>

    <main class="parent">
        <div class="child">
            <div class="Longread-ArticleB"></div>
        </div>

        <div class="child">
            <div class="Article-Header-Image"></div>
        </div>
        <div class="child">
            <header class="header">
                <a href="../html/peruse.html">
                    <img src="../Images/Peruse/PERUSE.png" alt="Peruse Logo" class="logo">
                </a>
                <button href="javascript:void(0);" class="icon burger-menu" onclick="myFunction()">☰</button>
            </header>
        
            <div class="topnav">
                <div id="myLinks">
                    <a href="#news" id="toggle-visibility"><h3>Unhide</h3></a>
                    <a href="#contact"><h3>Contact</h3></a>
                    <a href="#about"><h3>About</h3></a>
                </div>
            </div>
        </div>
        <div class="child">
            <div class="Longread-Content">
                <div class="metabubbles2">
                    <span class="tag2 finance2">finance</span>
                    <span class="tag2 feature2">
                        <img src="../Images/Peruse/Map.png" alt="">
                    </span>
                </div>
                <div class="Longread-Title">
                <h2>Saudi’s running out of oil, Oil reserve data 4</h2>
                <p>Recordings and interviews reveal he felt a growing discontent society and was increasingly isolated even with his local.</p>
                </div>
            <div class="Longread-meta">
                <h4>4 min read</h4>
               <p>Jan 04, 2024</p>
            </div>
            <br><br>
            <div class="Main-Longread">
                <div class="Longread-Header"></div>
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Mauris sollicitudin lacus sed elit egestas tincidunt. Integer non egestas lorem, in convallis odio. Nulla facilisi. Cras at congue ligula. Ut pharetra rutrum magna, vel euismod libero hendrerit vitae. Aenean varius congue nibh vel porttitor. Aenean sagittis laoreet augue sed semper. Duis pellentesque turpis et mauris accumsan rutrum.

                    Sed pretium diam nec orci aliquet blandit. Nam ac quam et metus rhoncus tincidunt. Etiam vel turpis quis nulla placerat blandit eget aliquet arcu. Integer id dictum dolor, ut tincidunt sem. Cras ac rhoncus arcu. Integer iaculis neque tortor. Maecenas mattis dui in ex aliquam viverra. In nec mauris dui. Curabitur quis faucibus sapien, ac tempus mauris.
                    
                    Fusce ultricies purus vel magna egestas venenatis fermentum ac purus. Sed non commodo ligula. Vestibulum ut magna efficitur, sodales tortor id, condimentum libero. Phasellus volutpat arcu vitae libero feugiat scelerisque. Mauris est felis, euismod sed justo a, ornare eleifend massa. Ut placerat mauris at sapien elementum posuere. Fusce quis tristique ligula. Donec porta elit a odio placerat tempus.
                    
                    Integer ut viverra ex. Aenean ligula turpis, malesuada ut faucibus sed, dapibus sed ligula. Fusce placerat, neque at tempor blandit, turpis arcu tincidunt enim, in iaculis augue tellus pellentesque dolor. Maecenas pharetra est id sodales gravida. Donec nunc libero, consectetur et elementum id, semper ut justo. Morbi sit amet nisl sagittis, scelerisque ante vitae, fermentum ex. Fusce rutrum bibendum nulla eget lobortis. Donec tempus euismod lectus, vel maximus lorem commodo nec. Duis arcu odio, molestie at ex vitae, ullamcorper faucibus massa. Praesent facilisis dolor risus, nec faucibus nisl egestas sed.
                    
                    Nullam eleifend quis purus ac posuere. Morbi sagittis magna ut malesuada vestibulum. Integer porttitor orci quis turpis vestibulum, non tempus odio sagittis. Donec augue nunc, tempus sed ligula vehicula, sodales tempus orci. Praesent sollicitudin odio sit amet arcu commodo, et euismod risus maximus. Aenean dolor nibh, sollicitudin vitae scelerisque et, semper in sem. Praesent nibh urna, consequat et purus quis, sodales sollicitudin justo. Donec elementum sollicitudin nunc in feugiat. In vitae sollicitudin ante. Vestibulum vel auctor ipsum.</p>
    
    
    
                    <div class="Longform-Image Image1">
                        
                    </div>
                    <p>Bron: Jort Siemes</p>

                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Mauris sollicitudin lacus sed elit egestas tincidunt. Integer non egestas lorem, in convallis odio. Nulla facilisi. Cras at congue ligula. Ut pharetra rutrum magna, vel euismod libero hendrerit vitae. Aenean varius congue nibh vel porttitor. Aenean sagittis laoreet augue sed semper. Duis pellentesque turpis et mauris accumsan rutrum.
    
                        Sed pretium diam nec orci aliquet blandit. Nam ac quam et metus rhoncus tincidunt. Etiam vel turpis quis nulla placerat blandit eget aliquet arcu. Integer id dictum dolor, ut tincidunt sem. Cras ac rhoncus arcu. Integer iaculis neque tortor. Maecenas mattis dui in ex aliquam viverra. In nec mauris dui. Curabitur quis faucibus sapien, ac tempus mauris.
                        
                        Fusce ultricies purus vel magna egestas venenatis fermentum ac purus. Sed non commodo ligula. Vestibulum ut magna efficitur, sodales tortor id, condimentum libero. Phasellus volutpat arcu vitae libero feugiat scelerisque. Mauris est felis, euismod sed justo a, ornare eleifend massa. Ut placerat mauris at sapien elementum posuere. Fusce quis tristique ligula. Donec porta elit a odio placerat tempus.
                        
                        Integer ut viverra ex. Aenean ligula turpis, malesuada ut faucibus sed, dapibus sed ligula. Fusce placerat, neque at tempor blandit, turpis arcu tincidunt enim, in iaculis augue tellus pellentesque dolor. Maecenas pharetra est id sodales gravida. Donec nunc libero, consectetur et elementum id, semper ut justo. Morbi sit amet nisl sagittis, scelerisque ante vitae, fermentum ex. Fusce rutrum bibendum nulla eget lobortis. Donec tempus euismod lectus, vel maximus lorem commodo nec. Duis arcu odio, molestie at ex vitae, ullamcorper faucibus massa. Praesent facilisis dolor risus, nec faucibus nisl egestas sed.
                        
                        Nullam eleifend quis purus ac posuere. Morbi sagittis magna ut malesuada vestibulum. Integer porttitor orci quis turpis vestibulum, non tempus odio sagittis. Donec augue nunc, tempus sed ligula vehicula, sodales tempus orci. Praesent sollicitudin odio sit amet arcu commodo, et euismod risus maximus. Aenean dolor nibh, sollicitudin vitae scelerisque et, semper in sem. Praesent nibh urna, consequat et purus quis, sodales sollicitudin justo. Donec elementum sollicitudin nunc in feugiat. In vitae sollicitudin ante. Vestibulum vel auctor ipsum.</p>
    
                        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Mauris sollicitudin lacus sed elit egestas tincidunt. Integer non egestas lorem, in convallis odio. Nulla facilisi. Cras at congue ligula. Ut pharetra rutrum magna, vel euismod libero hendrerit vitae. Aenean varius congue nibh vel porttitor. Aenean sagittis laoreet augue sed semper. Duis pellentesque turpis et mauris accumsan rutrum.
    
                            Sed pretium diam nec orci aliquet blandit. Nam ac quam et metus rhoncus tincidunt. Etiam vel turpis quis nulla placerat blandit eget aliquet arcu. Integer id dictum dolor, ut tincidunt sem. Cras ac rhoncus arcu. Integer iaculis neque tortor. Maecenas mattis dui in ex aliquam viverra. In nec mauris dui. Curabitur quis faucibus sapien, ac tempus mauris.
                            
                            Fusce ultricies purus vel magna egestas venenatis fermentum ac purus. Sed non commodo ligula. Vestibulum ut magna efficitur, sodales tortor id, condimentum libero. Phasellus volutpat arcu vitae libero feugiat scelerisque. Mauris est felis, euismod sed justo a, ornare eleifend massa. Ut placerat mauris at sapien elementum posuere. Fusce quis tristique ligula. Donec porta elit a odio placerat tempus.
                            
                            Integer ut viverra ex. Aenean ligula turpis, malesuada ut faucibus sed, dapibus sed ligula. Fusce placerat, neque at tempor blandit, turpis arcu tincidunt enim, in iaculis augue tellus pellentesque dolor. Maecenas pharetra est id sodales gravida. Donec nunc libero, consectetur et elementum id, semper ut justo. Morbi sit amet nisl sagittis, scelerisque ante vitae, fermentum ex. Fusce rutrum bibendum nulla eget lobortis. Donec tempus euismod lectus, vel maximus lorem commodo nec. Duis arcu odio, molestie at ex vitae, ullamcorper faucibus massa. Praesent facilisis dolor risus, nec faucibus nisl egestas sed.
                            
                            Nullam eleifend quis purus ac posuere. Morbi sagittis magna ut malesuada vestibulum. Integer porttitor orci quis turpis vestibulum, non tempus odio sagittis. Donec augue nunc, tempus sed ligula vehicula, sodales tempus orci. Praesent sollicitudin odio sit amet arcu commodo, et euismod risus maximus. Aenean dolor nibh, sollicitudin vitae scelerisque et, semper in sem. Praesent nibh urna, consequat et purus quis, sodales sollicitudin justo. Donec elementum sollicitudin nunc in feugiat. In vitae sollicitudin ante. Vestibulum vel auctor ipsum.</p>
            
    
    

            </div>
           

        </div>
        </div>

        

        <div class="Rating"> 
          <h3>Beoordeling van geloofwaardigheid</h3>
          <p>
            De mate waarin een artikel geloofwaardig is: <br>
            gebaseerd op factoren zoals de deskundigheid van de auteur, de betrouwbaarheid van de bronnen en de nauwkeurigheid van de gepresenteerde informatie.
          </p>
          <label for="slider_input">Op een schaal van (1–100): </label> <br>
          <div class="Range_container">
            <div class="range-slider">
              <div id="slider_thumb" class="range-slider_thumb"></div>
              <div class="range-slider_line">
                <div id="slider_line" class="range-slider_line-fill"></div>
              </div>
              <input id="slider_input" class="range-slider_input" type="range" value="50" min="0" max="100">
            </div>
          </div>
          <div class="container">
            <button id="submitBtn" class="btn inactive">Submit</button>
          </div>
        </div>

    <br><br><br><br>

    </main>

        <footer class="footer">
            <div id="back-to-top" class="footerdiv">
                <div class="scrollwatcher"></div>
                <br>
                <h4><a href="#top">BACK TO TOP</a></h4>
            </div>
        </footer>
    

        <script type="module">
           import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";

// Initialize Supabase client
const supabaseUrl = 'https://rgoydwojepkjbqzdldft.supabase.co';
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJnb3lkd29qZXBramJxemRsZGZ0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzk3MTMyMTYsImV4cCI6MjA1NTI4OTIxNn0.gjk1wM4DUaxAQV9H3zK3hzktav-Pjo40fEIDHR7DTWQ';
const supabaseClient = createClient(supabaseUrl, supabaseKey);

// User ID management functions
function getUserIdFromLocalStorage() {
  return localStorage.getItem("userId");
}
function isUserIdInLocalStorage() {
  return !!getUserIdFromLocalStorage();
}
function generateUUID() {
  return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, function (c) {
    const r = (Math.random() * 16) | 0,
          v = c === "x" ? r : (r & 0x3) | 0x8;
    return v.toString(16);
  });
}
function setUserIdInLocalStorage() {
  const newId = generateUUID();
  console.log("Generated UserID:", newId);
  localStorage.setItem("userId", newId);
}
if (!isUserIdInLocalStorage()) {
  setUserIdInLocalStorage();
}

// Function to insert data into the "scriptie_vertrouwen" table
async function insertScriptieVertrouwen(sliderValue, timeSpent) {
  const { data, error } = await supabaseClient
    .from("scriptie_vertrouwen")
    .insert([
      {
        slider_values: sliderValue,
        article_number: "B",
        user_id: getUserIdFromLocalStorage(),
        time_spent: timeSpent
      }
    ]);

  if (error) {
    console.error("Error inserting into scriptie_vertrouwen:", error);
  } else {
    console.log("Successfully inserted into scriptie_vertrouwen:", data);
  }
}

// Wait for the DOM to fully load
document.addEventListener("DOMContentLoaded", function () {
  // Record page load time (in milliseconds)
  const pageLoadTime = Date.now();

  // === New Slider Functionality ===
  const slider_input = document.getElementById("slider_input");
  const slider_thumb = document.getElementById("slider_thumb");
  const slider_line = document.getElementById("slider_line");
  const submitBtn = document.getElementById("submitBtn");
  let sliderChanged = false; // Initially, the slider has not been changed

  function showSliderValue() {
    slider_thumb.innerHTML = slider_input.value;
    const bulletPosition = slider_input.value / slider_input.max;
    const space = slider_input.offsetWidth - slider_thumb.offsetWidth;
    slider_thumb.style.left = (bulletPosition * space) + 'px';
    slider_line.style.width = slider_input.value + '%';
  }
  // Call once to set up initial position (without marking as changed)
  showSliderValue();
  window.addEventListener("resize", showSliderValue);
  slider_input.addEventListener('input', () => {
    showSliderValue();
    // Mark that the slider was changed by the user.
    if (!sliderChanged) {
      sliderChanged = true;
      // Update button appearance from inactive (grey) to active (green)
      submitBtn.classList.remove("inactive");
      submitBtn.classList.add("active");
    }
  }, false);

  // === Submit Button, Confirmation, Animation & Redirect ===
  if (submitBtn && slider_input) {
    submitBtn.addEventListener("click", async () => {
      // If slider hasn't been changed from its default value, ask for confirmation
      if (!sliderChanged) {
        const proceed = confirm("You have not changed the slider value from its default. Do you want to submit this number?");
        if (!proceed) {
          return; // Abort submission if user cancels
        }
      }
      const sliderValue = Number(slider_input.value);
      // Calculate time spent on page in seconds
      const timeSpent = Math.floor((Date.now() - pageLoadTime) / 1000);
      console.log("Submit clicked. Slider value:", sliderValue, "Time spent (s):", timeSpent);

      // Insert data into Supabase
      await insertScriptieVertrouwen(sliderValue, timeSpent);

      // Disable the button to prevent duplicate clicks and trigger animation using jQuery
      submitBtn.disabled = true;
      $(submitBtn).addClass('btn-progress');
      setTimeout(() => {
        $(submitBtn).addClass('btn-fill');
      }, 500);
      setTimeout(() => {
        $(submitBtn).removeClass('btn-fill').addClass('btn-complete');
      }, 4100);
      // Redirect after the animation finishes
      setTimeout(() => {
        window.location.href = "articleB.html";
      }, 4100);
    });
  } else {
    console.error("Submit button or slider element not found.");
  }
          
          
              // === Article Visibility & Toggle ===
              const options = ["A1", "A2", "A3", "A4"];
              const storageKey = "selectedAOption";
              let selectedOptionIndex = localStorage.getItem(storageKey);
          
              if (selectedOptionIndex === null) {
                selectedOptionIndex = Math.floor(Math.random() * options.length);
                localStorage.setItem(storageKey, selectedOptionIndex);
              } else {
                selectedOptionIndex = Number(selectedOptionIndex);
              }
          
              const selectedOption = options[selectedOptionIndex];
              const selectedElement = document.getElementById(selectedOption);
              if (selectedElement) {
                selectedElement.classList.remove("hidden");
                selectedElement.classList.add("visible");
              } else {
                console.error(`Element with id "${selectedOption}" not found.`);
              }
          
              const toggleLink = document.getElementById("toggle-visibility");
              if (toggleLink) {
                let isShowingAll = false; // Tracks whether all articles are visible
          
                toggleLink.addEventListener("click", function (e) {
                  e.preventDefault();
          
                  options.forEach(optionId => {
                    const element = document.getElementById(optionId);
                    if (element) {
                      if (isShowingAll) {
                        // Hide all articles except the selected one
                        if (optionId !== selectedOption) {
                          element.classList.remove("visible");
                          element.classList.add("hidden");
                        }
                      } else {
                        // Show all articles
                        element.classList.remove("hidden");
                        element.classList.add("visible");
                      }
                    } else {
                      console.error(`Element with id "${optionId}" not found.`);
                    }
                  });
          
                  toggleLink.innerHTML = isShowingAll ? "<h3>Show All</h3>" : "<h3>Hide</h3>";
                  isShowingAll = !isShowingAll;
                });
              } else {
                console.error('Toggle link with id "toggle-visibility" not found.');
              }
          
              // === Scroll-Dependent Article Background Color ===
              const article = document.querySelector(".Longread-ArticleB");
              if (article) {
                document.addEventListener("scroll", function () {
                  const scrollY = window.scrollY;
                  const maxScroll = document.documentElement.scrollHeight - window.innerHeight;
                  const fadeStart = maxScroll * 0.3; // Start fading at 30% scroll
                  const fadeEnd = maxScroll * 0.5;   // Fully black at 50% scroll
          
                  if (scrollY >= fadeStart && scrollY <= fadeEnd) {
                    let progress = (scrollY - fadeStart) / (fadeEnd - fadeStart);
                    let r = Math.round(69 * (1 - progress));
                    let g = Math.round(18 * (1 - progress));
                    let b = Math.round(18 * (1 - progress));
                    article.style.backgroundColor = `rgb(${r}, ${g}, ${b})`;
                  } else if (scrollY > fadeEnd) {
                    article.style.backgroundColor = "#000000"; // Fully black
                  } else {
                    article.style.backgroundColor = "#451212"; // Initial color
                  }
                });
              } else {
                console.error("Element with class 'Longread-ArticleB' not found.");
              }
          
              // === Scroll Watcher Progress Bar ===
              const scrollWatcher = document.querySelector('.scrollwatcher');
              if (scrollWatcher) {
                window.addEventListener('scroll', () => {
                  const scrollTop = window.scrollY;
                  const docHeight = document.documentElement.scrollHeight - window.innerHeight;
                  const progress = Math.min(scrollTop / docHeight, 1);
                  scrollWatcher.style.transform = `scaleX(${progress})`;
                });
              } else {
                console.error("Element with class 'scrollwatcher' not found.");
              }
          
              // === Back-to-Top Button ===
              const backToTopButton = document.getElementById("back-to-top");
              if (backToTopButton) {
                const toggleVisibility = () => {
                  const isScrollable = document.body.scrollHeight > window.innerHeight;
                  const isScrolled = window.scrollY > 0;
                  if (isScrollable && isScrolled) {
                    backToTopButton.classList.add("visible");
                  } else {
                    backToTopButton.classList.remove("visible");
                  }
                };
          
                backToTopButton.addEventListener("click", () => {
                  window.scrollTo({ top: 0, behavior: "smooth" });
                });
          
                window.addEventListener("scroll", toggleVisibility);
                window.addEventListener("resize", toggleVisibility);
                toggleVisibility();
              } else {
                console.error("Back-to-top element not found.");
              }
          
              // === Mobile Menu Toggle ===
              const menuToggle = document.getElementById("menu-toggle");
              if (menuToggle) {
                menuToggle.addEventListener("click", function(){
                  const links = document.getElementById("myLinks");
                  if (links) {
                    links.style.display = links.style.display === "block" ? "none" : "block";
                  } else {
                    console.error("Element with id 'myLinks' not found.");
                  }
                });
              }
          
              // === Adjust Widths for .scroll divs ===
              document.querySelectorAll('.scroll div').forEach(div => {
                const contentWidth = Array.from(div.children).reduce((total, child) => total + child.offsetWidth + 20, 0);
                div.style.width = `${contentWidth}px`;
              });
            });

            const slider_input = document.getElementById('slider_input'),
      slider_thumb = document.getElementById('slider_thumb'),
      slider_line = document.getElementById('slider_line');

function showSliderValue() {
  slider_thumb.innerHTML = slider_input.value;
  const bulletPosition = (slider_input.value /slider_input.max),
        space = slider_input.offsetWidth - slider_thumb.offsetWidth;

  slider_thumb.style.left = (bulletPosition * space) + 'px';
  slider_line.style.width = slider_input.value + '%';
}

showSliderValue();
window.addEventListener("resize",showSliderValue);
slider_input.addEventListener('input', showSliderValue, false);


          
    </script>

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
</body>
</html>
